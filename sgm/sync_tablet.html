<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>Usuarios</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">






</HEAD>
<xml id = xmlDoc></xml>
<xml id = xmlTemp></xml>
<xml id = xmlList></xml>
<xml id = xmlListRoles></xml>
<xml id = xmlListFaenas></xml>
<xml id = xmlMenu></xml>
<xml id = xmlImages></xml>
<SCRIPT language="JavaScript1.2" src="standard/vitcomz.js"></SCRIPT>
<script type="text/javascript" src="Scripts/jquery.min.js"></script>
<script type="text/javascript" src="/Scripts/cookie.js"></script>
<script type="text/javascript" src="/Scripts/deteccion.js"></script>
<!---->
<SCRIPT language="JavaScript1.2" src="/Scripts/download.js" type="text/javascript"></SCRIPT>

<SCRIPT>
<!--adding-->
var browser =  DetectBrowser();
var id_br = browser.substring(0,2);
if (id_br == 'IE'){
			var emp = getEmpresa();
}else if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR"){
			var emp = getEmpresaMoz();
}
var xmlestado;

//function GetUsuarios(){
//	var my_list = jQuery('#ul_li');
//	my_list.find('li').each(function(index, element){
//		my_list.find('li:eq(' + index + ')').removeClass(); 
//		if (index < 1){
//			my_list.find('li:eq(' + index + ')').addClass('visited');			
//		} else if (index == 1) {	
//			my_list.find('li:eq(' + index + ')').addClass('active');
//		}
//	});
//	
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sci/xml/sync_Usuarios.asp?RECURSO=GetUsuario";
//	url += "&VTZ=" + Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "usuarios.xml", "text/xml");
//		}
//}
//
//
//function GetLayoutFaena(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Bitacoras.asp?RECURSO=LayoutFaena";
//	 	url += "&FAENA=" + emp;
//		url += "&VTZ=" + Math.random();
//
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		if (!xmlestado){
//				window.open(url);
////		}else{
////			download(xmlDoc, "layout_gral.xml", "text/xml");
//		}
//}
//
//function GetList_Equipos(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Equipos.asp?RECURSO=ListEquiposPadres&CODIGO=NULL";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "List_Equipos.xml", "text/xml");
//		}
//}
//
//function GetListBitacora(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Bitacoras.asp?RECURSO=ListBitacora&RESPONSABLE=TOD&EQUIPO=TOD&EQUIPO_PRIN=TOD&IND_DANO=TOD&IND_SOLUCION=TOD&CRITICIDAD=TOD";
//	 	url += "&FAENA=" + emp;
//		url += "&VTZ=" + Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "List_bitacoras.xml", "text/xml");
//		}
//}
//
//
//function GetTipo(){
//	var my_list = jQuery('#ul_li');
//	my_list.find('li').each(function(index, element){
//		my_list.find('li:eq(' + index + ')').removeClass(); 
//		if (index < 1){
//			my_list.find('li:eq(' + index + ')').addClass('visited');			
//		} else if (index == 1) {	
//			my_list.find('li:eq(' + index + ')').addClass('active');
//		}
//	});
//
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Equipos.asp?RECURSO=GetTipo&CODIGO=NULL";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "List_Equipos_gettipo.xml", "text/xml");
//		}
//}
//
//function GetHistorial(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Historial.asp?RECURSO=listHisBit";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "List_historial.xml", "text/xml");
//		}
//}
//
//function GetListCheckDesc(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/Checklist_bkp.asp?RECURSO=ListCheckDesc";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "list_Checklist.xml", "text/xml");
//		}
//}
//
//function GetcheckFallas(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/Checklist_bkp.asp?RECURSO=ListCheck";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "list_Checklist_fallas.xml", "text/xml");
//		}
//}
//
//function GetPlanData(){
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "www.ttminsight.cl/sgm/xml/sync_Bitacoras.asp?RECURSO=getPlanData";
//		url += "&FAENA=" + emp;
//		url +="&VTZ="+Math.random();
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			download(xmlDoc, "list_plandata.xml", "text/xml");
//		}
//}
//
//function GetMovefiles(){
//	var my_list = jQuery('#ul_li');
//	my_list.find('li').each(function(index, element){
//		my_list.find('li:eq(' + index + ')').removeClass(); 
//		if (index < 2){
//			my_list.find('li:eq(' + index + ')').addClass('visited');			
//		} else if (index == 2) {	
//			my_list.find('li:eq(' + index + ')').addClass('active');
//		}
//	});
//	
//	var xmlDso = xmlDoc.XMLDocument;
//	var url = "GetMovefiles.php";
//		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
//		{
//					if (window.XMLHttpRequest)
//					  {// code for IE7+, Firefox, Chrome, Opera, Safari
//					  xmlhttp=new XMLHttpRequest();
//					  }
//					else
//					  {// code for IE6, IE5
//					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
//					  }
//					xmlhttp.open("GET",url,false);
//					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
//					xmlhttp.send();	
//					xmlDoc=xmlhttp.responseText;
//                    parser = new DOMParser();
//            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
//					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
//					//alert(xmlDso);
//					//window.open(url);
//		}
//		else if (id_br == "IE")
//		{
//			xmlestado = xmlDso.load(url);
//		}
//		//window.open(url);
//		if (!xmlestado){
//				window.open(url);
//		}else{
//			var my_list = jQuery('#ul_li');
//			my_list.find('li').each(function(index, element){
//				my_list.find('li:eq(' + index + ')').removeClass(); 
//				if (index < 3){
//					my_list.find('li:eq(' + index + ')').addClass('visited');			
//				} else if (index == 3) {	
//					my_list.find('li:eq(' + index + ')').addClass('active');
//				}
//			});
//			
//		}
//
//				
//}

function UploadBitacoras(){
	var my_list = jQuery('#ul_li');
	my_list.find('li').each(function(index, element){
		if (index == 0){
			my_list.find('li:eq(' + index + ')').addClass('active');
		} else if (index == 1){
			my_list.find('li:eq(' + index + ')').addClass('next');				
		} else {
			my_list.find('li:eq(' + index + ')').removeClass();          
		}
	});
}
function UploadHistorial(){
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/List_historial.xml";
		url += "?VTZ=" + Math.random();
		if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
		{
					if (window.XMLHttpRequest)
					  {// code for IE7+, Firefox, Chrome, Opera, Safari
					  xmlhttp=new XMLHttpRequest();
					  }
					else
					  {// code for IE6, IE5
					  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
					  }
					xmlhttp.open("GET",url,false);
					xmlhttp.setRequestHeader("Content-Type",  "text/plain; charset=windows-1252");
					xmlhttp.send();	
					xmlDoc=xmlhttp.responseText;
                    parser = new DOMParser();
            		xmlDso = parser.parseFromString(xmlDoc, "text/xml"); 
					xmlestado = parser.parseFromString(xmlDoc, "text/xml"); 
					//alert(xmlDso);
					//window.open(url);
		}
		else if (id_br == "IE")
		{
			xmlestado = xmlDso.load(url);
		}
		if(xmlestado){	
			if (id_br == "IE")
			{
				var x = xmlDso.getElementsByTagName("ROWS"); // mostramos los registros
				for (i=0; i<x.length; i++) {
					if (x[i].getElementsByTagName("OP")[0].childNodes[0]  != null){
						var url = "xml/save_historial.php?RECURSO=newHisBit";
						url += "&ID=" + x[i].getElementsByTagName("ID")[0].childNodes[0].nodeValue; // codeobj.value;
						url += "&INSPECTOR=" + x[i].getElementsByTagName("INSPECTOR")[0].childNodes[0].nodeValue;
						url += "&FECHA=" + x[i].getElementsByTagName("FECHA")[0].childNodes[0].nodeValue;
						url += "&ESTATUS=" + x[i].getElementsByTagName("STATUS")[0].childNodes[0].nodeValue;
						url += "&VTZ=" + Math.random();
					}
				}
			}
			else if (id_br == "FF" || id_br == "OP" || id_br == "SF"  || id_br == "CR")
			{

//------------------------------------------------------------------------------------------------	
				var x = xmlDso.getElementsByTagName("ROWS"); // mostramos los registros
				var context = "";
				
				for (i=0; i<x.length; i++) {
					if (x[i].getElementsByTagName("OP")[0].childNodes[0]  != null){
						var url = "www.ttminsight.cl/sgm/xml/save_historial.php?RECURSO=newHisBit";
						url += "&ID=" + x[i].getElementsByTagName("ID")[0].childNodes[0].nodeValue; // codeobj.value;
						url += "&INSPECTOR=" + x[i].getElementsByTagName("INSPECTOR")[0].childNodes[0].nodeValue;
						url += "&FECHA=" + x[i].getElementsByTagName("FECHA")[0].childNodes[0].nodeValue;
						url += "&ESTATUS=" + x[i].getElementsByTagName("STATUS")[0].childNodes[0].nodeValue;
						url += "&VTZ=" + Math.random();
						alert(url);
						document.getElementById("winframes").setAttribute("src", url); 
					}
				}
			}
//-------------------------------------------------------------------------------------------------				
				
		}
}

 
</SCRIPT>

<BODY>
<link rel="stylesheet" href="standard/progress_bar.css">
<h1>TTM Insight Sincronizacion Datos</h1>
<div class="checkout-wrap">
  <ul id="ul_li" class="checkout-bar">
    <li class="">Subir Datos</li>
    <li class="">Bajar Datos</li>
    <li class="">Restructurar Datos</li>
    <li class="">Sincronizar Datos</li>
    <li class="">Listo</li>
  </ul>
</div>
<iframe height="400" width="800" id="winframes"></iframe> 
<SCRIPT>
// ----------------es para la subida -------------------------------------
//	var my_list = jQuery('#ul_li');
//	my_list.find('li').each(function(index, element){
//		if (index == 0){
//			my_list.find('li:eq(' + index + ')').addClass('active');
//		} else if (index == 1){
//			my_list.find('li:eq(' + index + ')').addClass('next');			
//		} else {
//			my_list.find('li:eq(' + index + ')').removeClass();          
//		}
//	});
//---------------------------------------------------------------------------
	window.open("http://www.ttminsight.cl/sgm/down_xml.html");
	//document.getElementById("winframes").setAttribute("src", "down_xml.html"); 
	
	UploadBitacoras();
	UploadHistorial();
	
	var my_list = jQuery('#ul_li');
	my_list.find('li').each(function(index, element){
		my_list.find('li:eq(' + index + ')').removeClass(); 
		if (index < 4){
			my_list.find('li:eq(' + index + ')').addClass('visited');			
		} else if (index == 4) {	
			my_list.find('li:eq(' + index + ')').addClass('active');
		}
	});
	
</SCRIPT>
</BODY>
</HTML>