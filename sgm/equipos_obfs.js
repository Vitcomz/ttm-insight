
/*******************************************************************/
/*                                                                 */
/* Copyright (c) 2005-2009 Jasob.com                               */
/*                                                                 */
/* This obfuscated code was created by Jasob 3.5 Trial Version.    */
/* The code may be used for evaluation purposes only.              */
/* To obtain full rights to the obfuscated code you have to        */
/* purchase the license key (http://www.jasob.com/Purchase.html).  */
/*                                                                 */
/*******************************************************************/

l.async=false;var option="New";var indCalculo=false;function LimpiaF(){c.I.value="";c.txtSerie.value="";c.TxtDescripcion.value="";c.TxtHorometro.value="";c.J.value="";c.O.value="";c.L.value="";c.TxtCodEquipoPadre.value="";c.TxtDesEquipoPadre.value="";c.TxtFecha.value="";c.TxtRutProveedor.value="";c.TxtProveedor.value="";c.TxtFecha.value=o();c.txtFechaUltima.value="";};function Guardar(){if(c.I.value==""){alert("Ingrese el Codigo.");return;}if(c.TxtDescripcion.value==""){alert("Ingrese la Descripción.");return;}if(indCalculo==true){x=confirm("Desea Actualizar la fecha de Vencimiento");if(!x)return;}indCalculo=false;T.async=false;var d=T.XMLDocument;var url="xml/Equipos.asp?RECURSO=existeEquipo&CODIGO="+c.I.value;url+="&FAENA="+getEmpresa();url+="&VTZ="+Math.random();f=d.load(url);if(f){var K=d.documentElement;var M=K.childNodes.item(0);}else window.open(url);if(P(M,"RETURN")=="NOT")NewEquipo();else if(option=="Edit")UpdateEquipo();else alert("Codigo de equipo existente!");option="New";c.I.focus();};function GetEquipo(){l.async=false;var d=l.XMLDocument;var url="xml/Equipos.asp?RECURSO=GetEquipo&CODIGO="+c.I.value;url+="&FAENA="+getEmpresa();url+="&VTZ="+Math.random();f=d.load(url);if(!f)window.open(url);setTimeout("changeTipoHrm();",500);setTimeout("listArchivos();",500);option="Edit";};function color(){var myDate=new Date();var B=c.O.value-c.TxtHorometro.value;if(parseFloat(B)<=0)c.O.style.color='#FF0000';if(!c.O.value)return;if(c.listTipoHr.value=='CRO'){c.TxtHorometro.value=o();myDate.setTime(c.O.value);c.O.value=formatoFechaCorta(myDate);if(c.listEscala.value=='H')c.J.value=(c.J.value)/(1000*60*60);if(c.listEscalaAlr.value=='H')c.L.value=(c.L.value)/(1000*60*60);if(c.listEscala.value=='D')c.J.value=(c.J.value)/(1000*60*60*24);if(c.listEscalaAlr.value=='D')c.L.value=(c.L.value)/(1000*60*60*24);if(c.listEscala.value=='M')c.J.value=(c.J.value)/(1000*60*60*24*30.41666);if(c.listEscalaAlr.value=='M')c.L.value=(c.L.value)/(1000*60*60*24*30.41666);if(c.listEscala.value=='A')c.J.value=(c.J.value)/(1000*60*60*24*30.41666*12);if(c.listEscalaAlr.value=='A')c.L.value=(c.L.value)/(1000*60*60*24*30.41666*12);}};function C(){var myDate=new Date();switch(c.listEscala.value){case "H":g=c.J.value*1000*60*60;break;case "D":g=c.J.value*1000*60*60*24;break;case "M":g=c.J.value*1000*60*60*24*30.41666;break;case "A":g=c.J.value*1000*60*60*24*30.41666*12;break;}if(confirm("Desea Calcular la fecha de Vencimiento desde la ultima mantención")){if(c.TxtFechaUltMan.value!=""){var m=c.TxtFechaUltMan.value;var myDate=new Date(m.substr(6,4),m.substr(3,2)-1,m.substr(0,2))}}myDate.setTime(myDate.getTime()+g);c.O.value=formatoFechaCorta(myDate);indCalculo=true;};function ListEquipo(){var d=l.XMLDocument;var url="xml/Equipos.asp?RECURSO=GetEquipo";url+="&VTZ="+Math.random();f=d.load(url);};function DelEquipo(){var d=T.XMLDocument;var url="xml/Equipos.asp?RECURSO=DelEquipo&CODIGO="+c.I.value;if(confirm("Desea Eliminar?")){f=d.load(url);if(!f)window.open(url);else{alert("Equipo Eliminado.");LimpiaF();option="New"}}};function listArchivos(){k.async=false;var d=k.XMLDocument;var url="xml/archivos.asp?RECURSO=listArchivos";url+="&FAMILIA=EQUIPOS";url+="&IDENTIFICADOR="+c.I.value;url+="&VTZ="+Math.random();f=k.load(url);if(!f){window.open(url);}else{total_registros_lista=k.documentElement.childNodes.length;document.getElementById("ID_list_cant_reg").innerText=total_registros_lista;F=1;total_bloque_listado=Math.ceil(total_registros_lista/1);var A=document.getElementById("ID_list_fraccion_reg");A.innerText="1/"+total_bloque_listado;}};function newFile(){document.frameFiles.mostrarVentana(c.I,"EQUIPOS",G);};function delFile(){k.async=false;var d=k.XMLDocument;var url="xml/archivos.asp?RECURSO=delFile";url+="&FAMILIA=EQUIPOS";url+="&IDENTIFICADOR="+c.I.value;url+="&ID="+document.getElementById("txtID").innerText;url+="&VTZ="+Math.random();f=k.load(url);if(!f){window.open(url);}listArchivos();};function NewEquipo(){if(c.listTipos.value=="SEL"){alert("Seleccione el Tipo de Equipo");return;}if(c.listTipoHr.value=='CRO'){Horometro=(new Date()).getTime();sHorometroVen=c.O.value;HorometroVen=(new Date(sHorometroVen.substr(6,4),sHorometroVen.substr(3,2)-1,sHorometroVen.substr(0,2))).getTime();switch(c.listEscala.value){case "D":g=c.J.value*1000*60*60*24;break;case "M":g=c.J.value*1000*60*60*24*30.41666;break;case "A":g=c.J.value*1000*60*60*24*30.41666*12;break;}switch(c.listEscalaAlr.value){case "D":j=c.L.value*1000*60*60*24;break;case "M":j=c.L.value*1000*60*60*24*30.41666;break;case "A":j=c.L.value*1000*60*60*24*30.41666*12;break;}if(!c.O.value){g='';HorometroVen='';Horometro='';j='';}}else{g=c.J.value;HorometroVen=c.O.value;Horometro=c.TxtHorometro.value;j=c.L.value;}var d=l.XMLDocument;var url="xml/Equipos.asp?RECURSO=NewEquipo&CODIGO="+c.I.value;url+="&COD_EQUIPO_PADRE="+c.TxtCodEquipoPadre.value;url+="&ESTADO="+c.ListEstado.value;url+="&DESCRIPCION="+c.TxtDescripcion.value;url+="&DIMENSIONES="+c.txtDimensiones.value;url+="&HOROMETRO="+Horometro;url+="&HOROMETRO_MAN="+g;url+="&HOROMETRO_VEN="+HorometroVen;url+="&HOROMETRO_ALARM="+j;url+="&HOROMETRO_PADRE=MOT";url+="&FECHA="+c.TxtFecha.value;url+="&TIPO_HOR="+c.listTipoHr.value;url+="&TIPO_EQUIPO="+c.listTipos.value;url+="&ESCALA_ALARM="+c.listEscalaAlr.value;url+="&ANCHO="+c.txtAncho.value.replace(",",".");url+="&ESPESOR="+c.txtEspesor.value;url+="&ESPESOR_R="+c.txtEspesorR.value;url+="&FECHA_ULT_MAN="+c.txtFechaUltima.value;url+="&GSAP="+c.txtGSAP.value;url+="&RUT_PROVEEDOR="+getNumberRut(c.TxtRutProveedor.value);url+="&UBICACION="+c.ListFaenas.value;url+="&SECCION="+c.ListSecciones.value;url+="&CRITICIDAD="+c.txtCriticidad.value;url+="&OBSERVACION="+scape(c.txtObservacion.value);url+="&MARCA="+c.txtMarca.value;url+="&MODELO="+c.txtModelo.value;url+="&SERIE="+c.txtSerie.value;url+="&VTZ="+Math.random();f=d.load(url);if(!f){window.open(url);return;}var url="xml/equipos.asp?RECURSO=NewEquipoUsuario";url+="&CODIGO="+c.I.value;url+="&USUARIO="+GetSession();url+="&TIPO_HOR="+c.listTipoHr.value;url+="&VTZ="+Math.random();f=d.load(url);if(!f)window.open(url);else{alert("Equipo Ingresado.");LimpiaF();}};function UpdateEquipo(){if(c.listTipoHr.value=='CRO'){Horometro=(new Date()).getTime();sHorometroVen=c.O.value;HorometroVen=(new Date(sHorometroVen.substr(6,4),sHorometroVen.substr(3,2)-1,sHorometroVen.substr(0,2))).getTime();switch(c.listEscalaAlr.value){case "D":j=c.L.value*1000*60*60*24;break;case "M":j=c.L.value*1000*60*60*24*30.41666;break;case "A":j=c.L.value*1000*60*60*24*30.41666*12;break;}if(!c.O.value){g='';HorometroVen='';Horometro='';j='';}}else{g=c.J.value;HorometroVen=c.O.value;Horometro=c.TxtHorometro.value;j=c.L.value;}l.async=false;var d=l.XMLDocument;var url="xml/Equipos.asp?RECURSO=UpdateEquipo&CODIGO="+c.I.value;url+="&COD_EQUIPO_PADRE="+c.TxtCodEquipoPadre.value;url+="&CAPACIDAD="+c.txtCapacidad.value;url+="&ESTADO="+c.ListEstado.value;url+="&DESCRIPCION="+c.TxtDescripcion.value;url+="&DIMENSIONES="+c.txtDimensiones.value;url+="&HOROMETRO="+Horometro;url+="&HOROMETRO_MAN="+g;url+="&HOROMETRO_VEN="+HorometroVen;url+="&HOROMETRO_ALARM="+j;url+="&FECHA="+c.TxtFecha.value;url+="&FECHA_INST="+c.TxtFechaInstalacion.value;url+="&GSAP="+c.txtGSAP.value;url+="&TIPO_HOR="+c.listTipoHr.value;url+="&TIPO_EQUIPO="+c.listTipos.value;url+="&FAENA="+getEmpresa();url+="&ESCALA_ALARM="+c.listEscalaAlr.value;url+="&ANCHO="+c.txtAncho.value.replace(",",".");url+="&ESPESOR="+c.txtEspesor.value;url+="&ESPESOR_R="+c.txtEspesorR.value;url+="&FECHA_ULT_MAN="+c.txtFechaUltima.value;url+="&RUT_PROVEEDOR="+getNumberRut(c.TxtRutProveedor.value);url+="&UBICACION="+c.ListFaenas.value;url+="&SECCION="+c.ListSecciones.value;url+="&CRITICIDAD="+c.txtCriticidad.value.replace(',','.');url+="&OBSERVACION="+scape(c.txtObservacion.value);url+="&MARCA="+c.txtMarca.value;url+="&MODELO="+c.txtModelo.value;url+="&VIDA_UTIL="+c.txtVidaUtil.value;url+="&TON_SEMANAL="+c.txtTonSemanal.value;url+="&SERIE="+c.txtSerie.value;url+="&VTZ="+Math.random();f=d.load(url);if(!f)window.open(url);else{alert("Equipo Actualizado.");option="New";LimpiaF();}};function ListTipos(){T.async=false;var d=T.XMLDocument;var url="xml/Equipos.asp?RECURSO=ListTipos";url+="&VTZ="+Math.random();var Q=d.load(url);if(Q){var K=d.documentElement;H=new R("SELECCIONAR","SEL");if(H.value=="SEL")H.selected=true;c.listTipos.options[0]=H;for(var i=1;i<K.childNodes.length+1;i++){var M=K.childNodes.item(i-1);H=new R(P(M,"DESCRIPCION"),P(M,"CODIGO"));c.listTipos.options[i]=H;}}else window.open(url);};function ListGrupos(){var d=v.XMLDocument;var url="xml/Equipos.asp?RECURSO=ListGrupos";d.async=false;Q=d.load(url);if(Q){var K=d.documentElement;for(var i=0;i<K.childNodes.length;i++){var M=K.childNodes.item(i);H=new R(P(M,"DESCRIPCION"),P(M,"CODIGO"));if(H.value=="0")H.selected=true;c.ListGrupo.options[i]=H;}}};function ListHorometros(t){return;var d=v.XMLDocument;var url="xml/Equipos.asp?RECURSO=ListHorometros";if(t==1)url+="&COD_EQUIPO="+c.I.value;else url+="&COD_EQUIPO="+c.TxtCodEquipoPadre.value;c.ListHorometroPadre.options.length=0;d.async=false;Q=d.load(url);if(Q){var K=d.documentElement;for(var i=0;i<K.childNodes.length;i++){var M=K.childNodes.item(i);H=new R(P(M,"DESCRIPCION"),P(M,"CODIGO"));c.ListHorometroPadre.options[i]=H;}}c.ListHorometroPadre.value=c.TxtCodHorometro.value;};function GetProv(){};function verActividades(){var url="Actividades.html?Equipo="+c.I.value;url+="&Descripcion="+c.TxtDescripcion.value;window.location.href=url;};function verLayout(){frameLayout.showWin(c.I.value,D);};function verHistorial(){var url="informes/HistorialMan.html?EQUIPO="+c.I.value;window.location.href=url;};function verSubEquipos(){var url="TabEquipos.html?CodEquipo="+c.I.value;window.location.href=url;};function clrModelo(){c.txtModelo.value="";};function inicio(){var parametro=getParametro("CODIGO");if(parametro){c.I.value=parametro;GetEquipo();}c.TxtFecha.value=o();ListTipos();listFaenas();listSecciones();};function listFaenas(){U.async=false;var d=U.XMLDocument;var url="xml/Usuarios.asp?RECURSO=listFaenas";var Q=d.load(url);if(Q){var K=d.documentElement;for(var i=0;i<K.childNodes.length;i++){var M=K.childNodes.item(i);H=new R(P(M,"DESCRIPCION"),P(M,"DESCRIPCION"));if(H.value==r)H.selected=true;c.ListFaenas.options[i]=H;}}else window.open(url);};function listSecciones(){U.async=false;var d=U.XMLDocument;var url="xml/Secciones.asp?RECURSO=listSecciones";url+="&FAENA="+r;var Q=d.load(url);if(Q){var K=d.documentElement;for(var i=0;i<K.childNodes.length;i++){var M=K.childNodes.item(i);H=new R(P(M,"DESCRIPCION"),P(M,"CODIGO"));if(H.value==r)H.selected=true;c.ListSecciones.options[i]=H;}}else window.open(url);};function changeTipoHrm(){return;if(c.listTipoHr.value=='SEC'){c.listEscala.value='H';c.listEscala.disabled=true;c.listEscalaAlr.value='H';c.listEscalaAlr.disabled=true;}else{c.listEscala.disabled=false;c.listEscalaAlr.disabled=false;}}