<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>Servicios</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
}
-->
</style>






</head>
<xml id = xmlDoc></xml>
<xml id = XMLDoc></xml>
<xml id = xmlListRoles></xml>
<xml id = xmlMenu></xml>
<link rel="stylesheet" href="standard/menu.css" type="text/css">
<link rel="stylesheet" href="sci.css" type="text/css">
<script language="JavaScript1.2" src="standard/coolmenus4.js"></script>
<script>

var newEvent = false;
xmlDoc.async = false;


function GetInsumo()
{

	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=GetInsumo&CODIGO=" + formulario.TxtCodigo.value;
	xmlestado = xmlDso.load(url);
	if (!xmlestado)
			    window.open(url);
}

function ListInsumo()
{
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=ListInsumo";
    window.open(url);
	xmlestado = xmlDso.load(url);
}

function DelInsumo()
{
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=DelInsumo&CODIGO=" + formulario.TxtCodigo.value;
    //window.open(url);
	xmlestado = xmlDso.load(url);
}

function Nuevo(){

window.event.cancelBubble=true;
newEvent=true;
formulario.TxtCodigo.readOnly=false;
formulario.btnNew.className='hidden';
LimpiarForm();
setTimeout("formulario.TxtCodigo.focus();",800);
}

function Guardar(){

if (newEvent) NewInsumo();
else  UpdateInsumo();
newEvent =false;
formulario.TxtCodigo.readOnly = true;
formulario.btnNew.className='botonBlanco';
}

function NewInsumo()
{
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=NewInsumo&CODIGO=" + formulario.TxtCodigo.value;
		url += "&NOMBRE=" + formulario.TxtNombre.value;
		url += "&MARCA=" + formulario.TxtMarca.value;
		url += "&MODELO=" + formulario.TxtModelo.value;
		url += "&RUT_PROVEEDOR=" + formulario.TxtRut.value;
		url += "&SECCION=" + formulario.TxtSeccion.value;
		url += "&UBICACION=" + formulario.TxtUbicacion.value;
		url += "&VALOR=" + formulario.TxtValor.value;	
		xmlestado = xmlDso.load(url);
		if (!xmlestado)
			    window.open(url);
	   //alert(xmlestado);'
}

function UpdateInsumo()
{
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=UpdateInsumo&CODIGO=" + formulario.TxtCodigo.value;
		url += "&NOMBRE=" + formulario.TxtNombre.value;
		url += "&MARCA=" + formulario.ListMarca.value;
		url += "&MODELO=" + formulario.ListModelo.value;
		url += "&SECCION=" + formulario.TxtSeccion.value;
		url += "&UBICACION=" + formulario.TxtUbicacion.value;
		url += "&RUT_PROVEEDOR=" + formulario.TxtRut.value;
		url += "&VALOR=" + formulario.TxtValor.value;		
		//window.open(url);
	    xmlestado = xmlDso.load(url);
		if (!xmlestado)
			    window.open(url);
		else
				GetInsumo();
}


function GetProv()
{
	var xmlDso = xmlDoc.XMLDocument;
	var url = "xml/Insumos.asp?RECURSO=GetProv";
    //window.open(url);
	xmlestado = xmlDso.load(url);
	if (!xmlestado)
			    window.open(url);
}

</script>

<body onLoad="formulario.TxtCodigo.focus();">
<form name="formulario">
<script language="JavaScript1.2" src="standard/menudata.js"></script>

<DIV id="DivProv" style="VISIBILITY: hidden;BORDER-RIGHT: #dfdfdf 1px ridge; BORDER-TOP: #dfdfdf 1px ridge; Z-INDEX: 145; LEFT: 265px; ; BORDER-LEFT: #dfdfdf 1px ridge; BORDER-BOTTOM: #dfdfdf 1px ridge; POSITION: absolute; TOP: 90px"
onclick="event.cancelBubble=true">
<IFRAME name="ListFrameProv" src="ListProveedores.html" frameBorder="0" width="250" scrolling="no"	height="180"></IFRAME>
</DIV>

<DIV id="DivInsumo" style="VISIBILITY: hidden;BORDER-RIGHT: #dfdfdf 1px ridge; BORDER-TOP: #dfdfdf 1px ridge; Z-INDEX: 145; LEFT: 265px; ; BORDER-LEFT: #dfdfdf 1px ridge; BORDER-BOTTOM: #dfdfdf 1px ridge; POSITION: absolute; TOP: 90px"
onclick="event.cancelBubble=true">
<IFRAME name="ListFrameInsumo" src="ListInsumos.html" frameBorder="0" width="250" scrolling="no"	height="180"></IFRAME>
</DIV>
<br><br><br><br>
<table width="1031">
<tr>
  <td width="1023" height="31" class="titulo">Registro Servicios de Terceros </td>
</tr>
<tr><td>
	<table width="747"  height="204" border="0" cellpadding="1" cellspacing="1"  DATASRC="#xmlDoc">
	  <!--DWLayoutTable-->
	<tr class="texto" > 
		<td width="84" height="32" align="right">Codigo:</td> 
		<td width="656" align="left">
			<input name="TxtCodigo" type="text" class="input" id="TxtCodigo" size="16"
					maxlength="15" datafld="CODIGO" />
			<img src="images/lupa.jpg" align="top" style="cursor:hand" 
				onclick="ListFrameInsumo.popsearchbox(10, TxtCodigo, TxtCodigo, DivInsumo);" />		</td>
		</tr>
	<tr class="texto" >
	  <td height="31" align="right" valign="middle">Descripci&oacute;n:</td>
	  <td align="left"><input class="input" name="TxtNombre" type="text" id="TxtNombre" size="40" maxlength="35" datafld="NOMBRE"></td>
	  </tr>
	
	<tr class="texto" >
      <td height="37" align="right" valign="middle">Proveedor:</td>
      <td align="left">
	  	<input name="TxtProveedor" type="text" class="input" size="32" maxlength="15" datafld="NOMBRE_PROVEEDOR"/>
    		<img src="images/lupa.jpg" align="top" style="cursor:hand" 
				onclick="ListFrameProv.popsearchbox(10, TxtRut, TxtProveedor, DivProv)" />
				
        <input name="TxtRut" type="text" class="hidden" id="TxtRut" size="10" maxlength="10" datafld="RUT_PROVEEDOR">		</td>
      </tr>
	<tr align="center" valign="middle">
	  <td height="5" colspan="2"><p>&nbsp;
	    </p>
	    <p>
              <input name="btnNew" type="button" class="botonBlanco" onClick="NewInsumo();" value="Nuevo">
              <input name="button" type="button" class="botonBlanco" onClick="UpdateInsumo();" value="Actualizar">
              <input name="button" type="button" class="botonBlanco" 
			  		onClick="window.open('Informes/InformeInsumos.html');;" value="Informe">        
        </p></td>
	  </tr>
	</table>
</td></tr>
</table>
</form>
<br>

</body>
</html>